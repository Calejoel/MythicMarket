<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mythic Market ‚Ä¢ Godlike Micro Meme Coins</title>
  <link rel="icon" href="assets/favicon.ico" />

  <style>
    :root {
      --bg-gradient: linear-gradient(135deg, #00e0ff, #006eff);
      --section-gradient: linear-gradient(135deg, #d0f4ff, #a0d9ff);
      --header-gradient: linear-gradient(135deg, #004080, #001f3f);
      --text-color: #000;
      --header-text: #fff;
    }
    [data-theme="dark"] {
      --bg-gradient: linear-gradient(135deg, #001f3f, #004080);
      --section-gradient: linear-gradient(135deg, #003366, #002244);
      --header-gradient: linear-gradient(135deg, #000c1a, #001f3f);
      --text-color: #fff;
      --header-text: #fff;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background: var(--bg-gradient);
      color: var(--text-color);
      font-family: Arial, sans-serif;
      line-height: 1.6;
    }
    a {
      color: #00c2ff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    header {
      position: relative;
      background: #000;
      color: var(--header-text);
      text-align: center;
      padding: 2rem 1rem;
    }
    #theme-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #333;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
    }
    header img {
      max-width: 220px;
      margin-bottom: 0.5rem;
    }
    header h1 {
      color: #fff;
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    header p {
      opacity: 0.8;
      font-size: 1rem;
    }
    main {
      max-width: 800px;
      margin: 1.5rem auto;
      padding: 0 1rem;
    }
    details {
      margin-bottom: 1.5rem;
    }
    
    /* Updated section-title summary styles */
    summary.section-title {
      font-size: 1.5rem;
      padding: 0.75rem 1rem;
      background: var(--header-gradient);
      color: var(--header-text);
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      outline: none; /* remove default focus outline */
    }
    summary.section-title:hover,
    summary.section-title:focus {
      background-color: #005fa3;
      color: #00f0ff; /* neon cyan */
    }
    
    .section-content {
      padding: 1rem;
      background: var(--section-gradient);
      border-radius: 8px;
      margin-top: 0.5rem;
    }
    summary {
      list-style: none;
      transition: color 0.3s ease;
      outline: none; /* remove default focus outline */
    }
    summary::marker,
    summary::-webkit-details-marker {
      display: none;
      font-size: 0;
      color: transparent;
    }
    summary::before {
      content: "‚ñ∂";
      display: inline-block;
      margin-right: 0.5em;
      transform: rotate(0deg);
      transition: transform 0.2s ease-in-out;
    }
    details[open] summary::before {
      transform: rotate(90deg);
    }
    summary:hover,
    summary:focus {
      color: #004080;
      outline: none;
    }

    /* Updated nested 'How to Vote' summary styles */
    details details > summary {
      position: relative;
      padding-left: 1.5em;
      cursor: pointer;
      font-weight: 700;
      color: var(--text-color);
      transition: color 0.3s ease;
      outline: none;
    }

    details details > summary:hover,
    details details > summary:focus {
      color: #00f0ff; /* neon cyan */
    }

    details details > summary::before {
      content: "‚ñ∂";
      position: absolute;
      left: 0.3em;
      top: 50%;
      transform: translateY(-50%) rotate(0deg);
      transition: transform 0.2s ease-in-out;
      color: var(--text-color);
    }

    details details[open] > summary::before {
      transform: translateY(-50%) rotate(90deg);
    }

    details details[open] > summary {
      color: #00f0ff;
    }

    /* View Live Results button hover */
    .view-results-button {
      background: #004080;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      text-decoration: none;
      display: inline-block;
      transition: background-color 0.3s ease;
    }
    .view-results-button:hover,
    .view-results-button:focus {
      background-color: #0066cc;
      outline: none;
    }
    .countdown-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    .countdown-table th,
    .countdown-table td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    .countdown-table th {
      background: #005fa3;
      color: white;
    }
    .countdown-table img {
      width: 24px;
      height: 24px;
      vertical-align: middle;
      margin-right: 0.5rem;
    }
    footer {
      text-align: center;
      margin: 2rem 0;
      color: var(--text-color);
      font-size: 0.9rem;
    }
    .social-icons a {
      margin: 0 0.5rem;
      display: inline-block;
    }
    .social-icons img {
      width: 28px;
      height: 28px;
    }
    .community-links ul {
      list-style: disc;
      padding-left: 1.5rem; /* Increased padding */
      margin-top: 0.75rem;
      margin-bottom: 0;
    }
    .community-links li {
      margin-bottom: 0.5rem; /* Optional: add space between items */
    }
    .voting-embed {
      width: 100%;
      height: 480px;
      border: none;
      border-radius: 8px;
      max-width: 100%;
      display: block;
    }
    .spaced-list li {
      margin-bottom: 0.75rem;
    }
    .spaced-paragraphs p {
       margin-bottom: 1.5rem;
     }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background: #005fa3;
      color: white;
    }
    button.vote-btn {
      padding: 0.5rem 1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background: #004080;
      color: white;
    }
    button.vote-btn:hover {
      background: #0066cc;
    }
    .pagination {
      margin-top: 1rem;
      text-align: center;
    }
    .pagination button {
      margin: 0 0.25rem;
      padding: 0.5rem 1rem;
      border: none;
      background: #004080;
      color: white;
      cursor: pointer;
      border-radius: 6px;
    }
    .pagination button:hover {
      background: #0066cc;
    }
    .pagination button.current-page {
      background: #00c2ff;
      color: black;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <button id="theme-toggle">Toggle Dark Mode</button>
    <img src="assets/MythicMarketLogo.png" alt="Mythic Market Logo" />
    <h1>Mythic Market</h1>
    <p>Launching Low‚ÄêSupply Micro Meme Coin Collectibles based on Mythical Gods ‚Äî Voted by YOU</p>
    <p><a href="https://raw.githubusercontent.com/Calejoel/MythicMarketLitepaper/main/MythicMarketLitepaper.pdf" target="_blank">
      üìÑ View the Mythic Market Litepaper (PDF), See our vision, goals, and roadmap
    </a></p>
    <p>Join the socials below!</p>
    <div class="social-icons">
      <a href="https://t.me/MythicalMarket" target="_blank"><img src="assets/telegram-icon.png" alt="Telegram" /></a>
      <a href="https://x.com/Mythic_Market" target="_blank"><img src="assets/twitter-icon.png" alt="Twitter" /></a>
      <a href="https://linktr.ee/Mythic_Market" target="_blank"><img src="assets/link-icon.png" alt="Linktree" /></a>
      <a href="https://discord.gg/g5wBE95Zpc" target="_blank"><img src="assets/discord-icon.png" alt="Discord" /></a>
    </div>
  </header>

  <main>
    <!-- About Section (example) -->
  <details id="about-section" open>
  <summary class="section-title">About Mythic Market</summary>
  <div class="section-content spaced-paragraphs">
    <p>
      Mythic Market is a community-driven platform featuring low-supply micro meme coin collectibles on Solana, each inspired by mythical gods and launched through transparent community voting.
    </p>
    <p>
      Every token has a fixed supply of 5,000 coins, ensuring collectible scarcity and fostering true market-driven price discovery. Launch prices start low to reward early holders, with liquidity locked to guarantee trust and long-term value.
    </p>
    <p>
      We operate with true transparency, no private allocations, no insider advantages. Liquidity locked on launch, and announced buybacks and burns actively enhance scarcity, strengthening collectible rarity and market potential.
    </p>
    <p>
      Tokens are paired in SOL/USDC dual pools via Meteora, or SOL-only pools depending on strategy, enabling fair and decentralized price discovery.
    </p>
    <p><strong>Key Highlights:</strong></p>
    <ul class="spaced-list" style="padding-left: 1.25rem;">
      <li>Fixed 5,000 token supply per collectible</li>
      <li>Transparent, community-led launch process</li>
      <li>No private allocations or insider privileges</li>
      <li>Locked liquidity to ensure market integrity</li>
      <li>Strategic buybacks and burns to increase rarity</li>
      <li>SOL/USDC dual pools or SOL-only liquidity pools</li>
    </ul>
    <p>
      <strong>Collect the gods. Trade the legends. Embrace a truly decentralized and fair market.</strong>
    </p>
    <p>
      Join our community on Discord, Telegram, and follow us on X (Twitter) to stay informed and actively participate in the movement.
    </p>
  </div>
</details>

<details id="manifesto-section" open>
  <summary class="section-title">Mythic Market Manifesto</summary>
  <div class="section-content spaced-paragraphs">
    <p><strong>Promoting Fairness, Transparency, and Community in Crypto Collectibles</strong></p>
    <p>
      We are united by a shared belief in the founding ideals of cryptocurrency: openness, fairness, and decentralized control. We reject the growing tide of projects that prioritize quick profits, hidden agendas, or exploit the trust of their communities.
    </p>
    <p>
      Meme coins and crypto collectibles should be built to empower their holders, not to enrich insiders, influencers, or opportunists through opaque deals and unfair advantages. We have to stop allowing public figures to exploit the people with their "CTO's", their insider riddled pre launched coins, it has to end.
    </p>
    <p>At Mythic Market, we stand firm on these principles:</p>
    <ul class="spaced-list" style="padding-left: 1.25rem;">
      <li><strong>Complete Openness:</strong> Every aspect of our launches is public and verifiable. There are no secret allocations, no presales, and no special access reserved for insiders.</li>
      <li><strong>Equal Opportunity for All:</strong> Our tokens are released fairly, with no reserved shares for teams, VCs, or early backers. Everyone has a level playing field from the start.</li>
      <li><strong>Market-Led Value:</strong> Prices are determined solely by genuine supply and demand, free from manipulation or artificial pumping.</li>
      <li><strong>Locked Liquidity for Holder Protection:</strong> Liquidity is securely locked to prevent rug pulls and protect the community‚Äôs interests.</li>
      <li><strong>Designed Scarcity:</strong> Limited fixed supplies promote rarity and sustainable value, rewarding long-term holders and collectors.</li>
      <li><strong>Community First:</strong> We prioritize the interests of the collective over individuals, ensuring that our ecosystem is governed by market forces and community engagement, not centralized power.</li>
    </ul>
    <p>
      Our mission goes beyond launching tokens; it‚Äôs about restoring trust and integrity to the crypto space. We invite everyone who shares these values to join us in building a future where meme coins are fair, transparent, and truly owned by their communities. We support any project that can stand by these ideals.
    </p>
    <p><strong>Together, we create a space where value emerges naturally, and every participant has a voice.</strong></p>
  </div>
</details>


    <!-- Countdown Table Section -->
    <details id="upcoming-section" open>
      <summary class="section-title">Upcoming Token Launches</summary>
      <div class="section-content overflow-hidden rounded-t-2xl">
        <p>Subject to change. VOTE NOW, YOU DECIDE THE FATES! The next God could change at any point, and timings may change to best fit the community, and/or market conditions.</p>
        <table class="countdown-table w-full border-collapse">
          <thead class="bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 text-white">
            <tr>
              <th class="px-4 py-2 rounded-tl-2xl text-left">Token</th>
              <th class="px-4 py-2 text-left">Launch Date (UTC/GMT)</th>
              <th class="px-4 py-2 text-left">Chart</th>
              <th class="px-4 py-2 rounded-tr-2xl text-left">Countdown / Link</th>
            </tr>
          </thead>
          <tbody id="token-data" class="bg-white dark:bg-gray-900">
        <!-- JS will insert rows here -->
          </tbody>
        </table>
      </div>
    </details>

    
    <details id="vote-section" open>
      <summary class="section-title">Vote for the Next God</summary>
      <div class="section-content">
        <p>Select from a community-curated list of Mythic Gods. up to 10 UNIQUE VOTES EVERY 7 DAYS!</p>
        <table id="voting-table">
          <thead>
            <tr>
              <th>God</th>
              <th>Votes</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="voting-rows"></tbody>
        </table>
        <div class="pagination" id="pagination"></div>
      </div>
    </details>
  </main>

  <footer>
    <p>¬© 2025 Mythic Market. Not financial advice. DYOR.</p>
    <div class="social-icons">
      <a href="https://t.me/MythicalMarket" target="_blank"><img src="assets/telegram-icon.png" alt="Telegram" /></a>
      <a href="https://x.com/Mythic_Market" target="_blank"><img src="assets/twitter-icon.png" alt="Twitter" /></a>
      <a href="https://linktr.ee/Mythic_Market" target="_blank"><img src="assets/link-icon.png" alt="Linktree" /></a>
      <a href="https://discord.gg/g5wBE95Zpc" target="_blank"><img src="assets/discord-icon.png" alt="Discord" /></a>
    </div>
  </footer>

  <!-- ========================= -->
  <!-- DARK MODE TOGGLE SCRIPT -->
  <!-- ========================= -->
  <script>
    const root = document.documentElement;
    const themeToggle = document.getElementById('theme-toggle');
    const saved = localStorage.getItem('theme');
    if (saved) {
      root.setAttribute('data-theme', saved);
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      root.setAttribute('data-theme', 'dark');
    }
    themeToggle.addEventListener('click', () => {
      const current = root.getAttribute('data-theme');
      const next = (current === 'dark' ? 'light' : 'dark');
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });
  </script>

  <!-- ========================= -->
  <!-- COUNTDOWN + TABLE SCRIPT -->
  <!-- ========================= -->
  <script>
  // 1) CONFIGURE YOUR TOKENS HERE
  const tokenData = [
    {
      name: "ARES",
      symbol: "ARES",
      image: "assets/ARES.png",
      mint: "HJ8Z8qkLXKS8HLCQEFquTXierjZKLnnkBAn4nTaDBZy1",
      chartUrl: "https://dexscreener.com/solana/Db8JBMfpNxCykttnyADX4ZyVzAZ6pW4JRD5HS8JQeCTe?embed=1&loadChartSettings=0&chartLeftToolbar=0&chartTheme=dark&theme=dark&chartStyle=0&chartType=usd&interval=15",
      launchDate: "2025-06-08T19:00:00Z"
    },
    {
      name: "ZEUS",
      symbol: "ZEUS",
      image: "assets/ZEUS.png",
      mint: "null",
      chartUrl: "https://dexscreener.com/solana/EXAMPLEZEUS", // Replace with actual link
      launchDate: "2025-06-22T19:00:00Z"
    },
    {
      name: "THOR",
      symbol: "THOR",
      image: "assets/THOR.png",
      mint: "null",
      chartUrl: "https://dexscreener.com/solana/EXAMPLETHOR", // Replace with actual link
      launchDate: "2025-06-29T19:00:00Z"
    },
    // Add more tokens similarly...
  ];

  function truncateMint(mint) {
    return mint.slice(0, 4) + "..." + mint.slice(-4);
  }

  function renderTokenRows() {
    const tbody = document.getElementById("token-data");
    tbody.innerHTML = "";

    tokenData.forEach((token, index) => {
      // Main Row
      const row = document.createElement("tr");

      // Token Cell
      const tokenCell = document.createElement("td");
      tokenCell.innerHTML = `
        <img src="${token.image}" alt="${token.symbol}" width="24" height="24" />
        <strong>${token.name}</strong> (${token.symbol})
      `;
      row.appendChild(tokenCell);

      // Launch Date Cell
      const launchCell = document.createElement("td");
      const launchDateObj = new Date(token.launchDate);
      launchCell.innerText = launchDateObj.toUTCString();
      row.appendChild(launchCell);

      // Countdown / Link Cell
      const countdownCell = document.createElement("td");
      countdownCell.id = "countdown-" + index;
      row.appendChild(countdownCell);

      // Chart Toggle Cell
      const chartCell = document.createElement("td");
      const chartToggleBtn = document.createElement("button");
      chartToggleBtn.textContent = "Show Chart";
      chartToggleBtn.className = "vote-btn";
      chartToggleBtn.onclick = () => {
        const chartRow = document.getElementById("chart-row-" + index);
        if (chartRow.style.display === "table-row") {
          chartRow.style.display = "none";
          chartToggleBtn.textContent = "Show Chart";
        } else {
          chartRow.style.display = "table-row";
          chartToggleBtn.textContent = "Hide Chart";
        }
      };
      chartCell.appendChild(chartToggleBtn);
      row.appendChild(chartCell);

      tbody.appendChild(row);

      // Chart Row
      const chartRow = document.createElement("tr");
      chartRow.id = "chart-row-" + index;
      chartRow.style.display = "none";

      const chartCellFull = document.createElement("td");
      chartCellFull.colSpan = 4; // Adjust based on total columns
      chartCellFull.innerHTML = `
        <div id="dexscreener-embed" style="position:relative;width:100%;padding-bottom:125%;margin-top:1rem;">
          <iframe src="${token.chartUrl}" style="position:absolute;width:100%;height:100%;top:0;left:0;border:0;border-radius:8px;"></iframe>
        </div>
      `;
      chartRow.appendChild(chartCellFull);

      tbody.appendChild(chartRow);
    });
  }

  function updateCountdowns() {
    tokenData.forEach((token, index) => {
      const now = new Date();
      const launchDate = new Date(token.launchDate);
      const diff = launchDate - now;

      const countdownCell = document.getElementById("countdown-" + index);
      if (!countdownCell) return;

      if (diff <= 0) {
        if (token.mint && token.mint !== "null") {
          const shortMint = truncateMint(token.mint);
          countdownCell.innerHTML = `
            <a href="https://solscan.io/token/${token.mint}" target="_blank" class="text-blue-500 hover:underline">
              ${shortMint}
            </a>`;
        } else {
          countdownCell.innerHTML = `<em>Launched, CA in Telegram + Discord!</em>`;
        }
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);

      countdownCell.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
    });
  }

  renderTokenRows();
  updateCountdowns();
  setInterval(updateCountdowns, 1000);
 </script>

  <!-- ========================= -->
  <!-- SUMMARY COLOR RESET SCRIPT -->
  <!-- ========================= -->
  <script>
    // Reset summary color on blur (when clicking away)
    document.querySelectorAll('summary').forEach(summary => {
      summary.addEventListener('blur', () => {
        summary.style.color = '';
      });

      // Optional: ensure color resets on click outside
      summary.addEventListener('click', () => {
        // Delay blur reset for accessibility (some browsers)
        setTimeout(() => {
          if (document.activeElement !== summary) {
            summary.style.color = '';
          }
        }, 100);
      });
    });
  </script>
  <script>
  // List only the IDs of the details you want to track
  const detailsToRemember = ["about-section", "manifesto-section"];

  detailsToRemember.forEach((id) => {
    const details = document.getElementById(id);
    if (!details) return;

    // Load saved state if any
    const isOpen = localStorage.getItem(`details-${id}`);
    if (isOpen === "true") {
      details.open = true;
    } else if (isOpen === "false") {
      details.open = false;
    }

    // Save state on toggle
    details.addEventListener("toggle", () => {
      localStorage.setItem(`details-${id}`, details.open);
    });
  });
</script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getDatabase, ref, runTransaction, onValue, get, child, set } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDSyissVOKDN-ZYYC4a0GclaxTWzjaMctU",
    authDomain: "mythicmarketvoting.firebaseapp.com",
    databaseURL: "https://mythicmarketvoting-default-rtdb.europe-west1.firebasedatabase.app/",
    projectId: "mythicmarketvoting",
    storageBucket: "mythicmarketvoting.appspot.com",
    messagingSenderId: "53404709260",
    appId: "1:53404709260:web:a5946515cda8157dd3e6a9",
    measurementId: "G-PXH24BW4NZ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Full gods list with keys and labels
  const gods = [
    { key: "zeus", label: "‚ö° Zeus ‚Äì Greek God of the Sky and Thunder" },
    { key: "poseidon", label: "üåä Poseidon ‚Äì Greek God of the Sea" },
    { key: "ares", label: "üî• Ares ‚Äì Greek God of War" },
    { key: "hades", label: "üåë Hades ‚Äì Greek God of the Underworld" },
    { key: "athena", label: "ü¶â Athena ‚Äì Greek Goddess of Wisdom and War Strategy" },
    { key: "aphrodite", label: "üíò Aphrodite ‚Äì Greek Goddess of Love and Beauty" },
    { key: "apollo", label: "üéØ Apollo ‚Äì Greek God of the Sun, Music, and Prophecy" },
    { key: "artemis", label: "üèπ Artemis ‚Äì Greek Goddess of the Hunt and Moon" },
    { key: "demeter", label: "üåæ Demeter ‚Äì Greek Goddess of Agriculture and Harvest" },
    { key: "persephone", label: "‚ôªÔ∏è Persephone ‚Äì Greek Goddess of Spring and Queen of the Underworld" },
    { key: "hecate", label: "‚ô†Ô∏è Hecate ‚Äì Greek Goddess of Magic, Witchcraft, and the Night" },
    { key: "dionysus", label: "üé≠ Dionysus ‚Äì Greek God of Wine, Festivity, and Madness" },
    { key: "hermes", label: "ü¶Ö Hermes ‚Äì Greek God of Trade, Thieves, and Messenger of the Gods" },
    { key: "achilles", label: "üó°Ô∏è Achilles ‚Äì Greek Hero, Greatest Warrior of the Trojan War" },
    { key: "thanatos", label: "üïäÔ∏è Thanatos ‚Äì Greek God of Death" },
    { key: "hestia", label: "‚ö° Hestia ‚Äì Greek Goddess of Hearth and Home" },
    { key: "panacea", label: "üåø Panacea ‚Äì Greek Goddess of Healing and Remedies" },
    { key: "heracles", label: "ü¶Å Heracles ‚Äì Greek Hero Known for His Strength and the Twelve Labors" },
    { key: "helios", label: "üåû Helios ‚Äì Greek Sun God before Apollo" },
    { key: "selene", label: "üåô Selene ‚Äì Greek Goddess of the Moon" },
    { key: "odin", label: "ü¶Ö Odin ‚Äì Norse Allfather God of Wisdom, War, and Death" },
    { key: "thor", label: "‚ùÑÔ∏è Thor ‚Äì Norse God of Thunder and Strength" },
    { key: "loki", label: "üßä Loki ‚Äì Norse God of Mischief and Trickery" },
    { key: "heimdall", label: "üõ°Ô∏è Heimdall ‚Äì Norse Guardian of the Bifrost Bridge" },
    { key: "freya", label: "ü™∂ Freya ‚Äì Norse Goddess of Love, Beauty, and Fertility" },
    { key: "fenrir", label: "üê∫ Fenrir ‚Äì Norse Giant Wolf, Son of Loki" },
    { key: "jormungandr", label: "üêç J√∂rmungandr ‚Äì Norse World Serpent" },
    { key: "baldr", label: "ü¶Å Baldr ‚Äì Norse God of Beauty, Love, and Happiness" },
    { key: "njord", label: "üå™Ô∏è Njord ‚Äì Norse God of the Sea and Winds" },
    { key: "skoll", label: "üê∫ Sk√∂ll ‚Äì Norse Wolf Chasing the Sun" },
    { key: "nidhogg", label: "üêç Nidhogg ‚Äì Norse Dragon Serpent Gnawing at the World Tree" },
    { key: "ra", label: "üåû Ra ‚Äì Egyptian Sun God" },
    { key: "set", label: "ü¶Ç Set ‚Äì Egyptian God of Chaos, Desert, Storms, and War" },
    { key: "horus", label: "ü¶Ö Horus ‚Äì Egyptian God of the Sky and Kingship" },
    { key: "anubis", label: "üå¨Ô∏è Anubis ‚Äì Egyptian God of Mummification and Afterlife" },
    { key: "isis", label: "ü™∑ Isis ‚Äì Egyptian Goddess of Magic, Marriage, Healing, and Protection" },
    { key: "osiris", label: "üåæ Osiris ‚Äì Egyptian God of the Dead and Resurrection" },
    { key: "maat", label: "‚öñÔ∏è Ma‚Äôat ‚Äì Egyptian Goddess of Truth, Justice, and Order" },
    { key: "bastet", label: "üêÖ Bastet ‚Äì Egyptian Goddess of Home, Fertility, and Cats" },
    { key: "wadjet", label: "üêç Wadjet ‚Äì Egyptian Cobra Goddess and Protector of Lower Egypt" },
    { key: "amaterasu", label: "üåü Amaterasu ‚Äì Japanese Sun Goddess" },
    { key: "izanami", label: "üå∏ Izanami ‚Äì Japanese Goddess of Creation and Death" },
    { key: "pele", label: "üî• Pele ‚Äì Hawaiian Goddess of Volcanoes and Fire" },
    { key: "saraswati", label: "ü¶ö Saraswati ‚Äì Hindu Goddess of Knowledge, Music, Art, Wisdom, and Learning" },
    { key: "ganesha", label: "ü¶è Ganesha ‚Äì Hindu God of Wisdom, Success, and Remover of Obstacles" },
    { key: "indra", label: "‚ö° Indra ‚Äì Hindu God of Thunder, Rain, and War" },
    { key: "agni", label: "üî• Agni ‚Äì Hindu God of Fire and Sacrifice" },
    { key: "kartikeya", label: "ü¶ö Kartikeya ‚Äì Hindu God of War" },
    { key: "naga", label: "üêâ Naga ‚Äì Hindu/Asian Mythical Serpent" },
    { key: "merlin", label: "üßô Merlin ‚Äì Legendary Wizard from Arthurian Legend" },
    { key: "kingarthur", label: "üëë King Arthur ‚Äì Legendary British Leader and Knight of the Round Table" },
    { key: "fafnir", label: "üêâ Fafnir ‚Äì Norse Dragon, Formerly a Dwarf" },
    { key: "lilith", label: "ü¶á Lilith ‚Äì Figure from Jewish Mythology, First Wife of Adam and Demoness" },
    { key: "kukulkan", label: "üêç Kukulkan ‚Äì Mesoamerican Feathered Serpent Deity" },
    { key: "pegasus", label: "üê¥ Pegasus ‚Äì Winged Divine Horse in Greek Mythology" },
    { key: "garuda", label: "ü¶Ö Garuda ‚Äì Hindu and Buddhist Divine Bird and Vehicle of Vishnu" },
    { key: "morrigan", label: "üê¶ Morrigan ‚Äì Celtic Goddess of War, Fate, and Death" },
    { key: "zephyrus", label: "üå™Ô∏è Zephyrus ‚Äì Greek God of the West Wind" },
    { key: "babayaga", label: "üßô‚Äç‚ôÄÔ∏è Baba Yaga ‚Äì Slavic Mythical Witch" },
    { key: "nuwa", label: "üêâ N√ºwa ‚Äì Chinese Goddess Who Created Humanity" },
    { key: "guanyu", label: "‚öîÔ∏è Guan Yu ‚Äì Chinese God of War and Loyalty" },
    { key: "quirinus", label: "ü¶Ö Quirinus ‚Äì Roman God of War" },
    { key: "hecate2", label: "üåü Hecate ‚Äì Greek Goddess of Magic and Crossroads" },
    { key: "maui", label: "üó°Ô∏è Maui ‚Äì Polynesian Demigod and Trickster" },
    { key: "tlaloc", label: "üåä Tlaloc ‚Äì Aztec God of Rain and Fertility" },
    { key: "epona", label: "ü¶Å Epona ‚Äì Celtic Goddess of Horses and Fertility" },
    { key: "kuanyin", label: "üå∏ Kuan Yin ‚Äì East Asian Goddess of Mercy and Compassion" },
    { key: "minerva", label: "ü¶â Minerva ‚Äì Roman Goddess of Wisdom (Greek Athena Equivalent)" },
    { key: "vulcan", label: "üî• Vulcan ‚Äì Roman God of Fire and Forge (Greek Hephaestus Equivalent)" },
    { key: "zephyr", label: "ü¶Ö Zephyr ‚Äì Greek West Wind God" },
    { key: "change", label: "üåï Chang‚Äôe ‚Äì Chinese Moon Goddess" },
    { key: "sunwukong", label: "üêí Sun Wukong ‚Äì Chinese Monkey King god" }
  ];

  // Utility: generate UUIDv4 for user id
  function generateUUID() {
    // https://stackoverflow.com/a/2117523/355230
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      const r = Math.random() * 16 | 0,
            v = c === 'x' ? r : (r & 0x3 | 0x8);
      return v.toString(16);
    });
  }

  // Get or create userId in localStorage
  let userId = localStorage.getItem('mythicmarket-userid');
  if (!userId) {
    userId = generateUUID();
    localStorage.setItem('mythicmarket-userid', userId);
  }

  const votingRows = document.getElementById('voting-rows');
  const pagination = document.getElementById('pagination');
  const maxVotesPerWeek = 10;
  const oneWeekMs = 7 * 24 * 60 * 60 * 1000;

  let votesData = {};
  let currentPage = 1;
  let userVotesThisWeek = {};

  // Load total votes for all gods & user votes for this user
  gods.forEach(god => {
    const voteRef = ref(db, 'votes/' + god.key + '/count');
    onValue(voteRef, (snapshot) => {
      votesData[god.key] = snapshot.val() || 0;
      renderTable();
    });
  });

  // Load user votes data for the current user
  async function loadUserVotes() {
    const userVotesRef = ref(db, 'userVotes/' + userId);
    const snapshot = await get(userVotesRef);
    const data = snapshot.val() || {};
    const now = Date.now();

    // Filter votes in last 7 days
    userVotesThisWeek = {};
    Object.entries(data).forEach(([godKey, timestamp]) => {
      if (now - timestamp < oneWeekMs) {
        userVotesThisWeek[godKey] = timestamp;
      }
    });
    renderTable();
  }

  loadUserVotes();

  async function vote(godKey) {
    const now = Date.now();

    // Reload user votes fresh to avoid stale data (optional for better accuracy)
    await loadUserVotes();

    // Check if user already voted for this god in last 7 days
    if (userVotesThisWeek[godKey]) {
      alert(`You have already voted for ${getGodLabel(godKey)} this week.`);
      return;
    }

    // Check if user reached max votes for the week
    if (Object.keys(userVotesThisWeek).length >= maxVotesPerWeek) {
      alert(`You have reached the max of ${maxVotesPerWeek} votes this week.`);
      return;
    }

    // 1) Increment total votes atomically
    const voteCountRef = ref(db, 'votes/' + godKey + '/count');
    await runTransaction(voteCountRef, (current) => (current || 0) + 1);

    // 2) Add this vote to user's votes with timestamp
    const userVoteRef = ref(db, `userVotes/${userId}/${godKey}`);
    await set(userVoteRef, now);

    alert(`Thanks for voting for ${getGodLabel(godKey)}! You have ${maxVotesPerWeek - Object.keys(userVotesThisWeek).length - 1} votes left this week.`);

    // Reload user votes and update UI
    await loadUserVotes();
  }

  function getGodLabel(key) {
    const god = gods.find(g => g.key === key);
    return god ? god.label : key;
  }

  // Render the voting table
  function renderTable() {
    // Sort gods descending by total votes
    const sortedGods = [...gods].sort((a, b) => (votesData[b.key] || 0) - (votesData[a.key] || 0));

    // Pagination logic
    const start = (currentPage - 1) * 10;
    const end = start + 10;
    const paginated = sortedGods.slice(start, end);

    votingRows.innerHTML = '';

    paginated.forEach(god => {
      const row = document.createElement('tr');

      const nameCell = document.createElement('td');
      nameCell.textContent = god.label;
      row.appendChild(nameCell);

      const voteCell = document.createElement('td');
      voteCell.textContent = votesData[god.key] || 0;
      row.appendChild(voteCell);

      const actionCell = document.createElement('td');
      const btn = document.createElement('button');
      btn.textContent = userVotesThisWeek[god.key] ? "Voted" : "Vote";
      btn.disabled = !!userVotesThisWeek[god.key];
      btn.className = 'vote-btn';
      btn.onclick = () => vote(god.key);
      actionCell.appendChild(btn);
      row.appendChild(actionCell);

      votingRows.appendChild(row);
    });

    renderPagination(sortedGods.length);

    // Show votes left info below the table
    let votesLeft = maxVotesPerWeek - Object.keys(userVotesThisWeek).length;
    votesLeft = votesLeft < 0 ? 0 : votesLeft;
    const infoId = 'votes-left-info';
    let info = document.getElementById(infoId);
    if (!info) {
      info = document.createElement('p');
      info.id = infoId;
      info.style.marginTop = '1rem';
      votingRows.parentElement.appendChild(info);
    }
    info.textContent = `You have ${votesLeft} vote${votesLeft !== 1 ? 's' : ''} left this week.`;
  }

  // Pagination buttons render
  function renderPagination(total) {
    const totalPages = Math.ceil(total / 10);
    pagination.innerHTML = '';
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement('button');
      btn.textContent = i;
      btn.className = 'vote-btn';
      btn.disabled = (i === currentPage);
      btn.onclick = () => {
  currentPage = i;
  renderTable();
      };
      if (i === currentPage) {
  btn.classList.add('current-page');
}
      pagination.appendChild(btn);
    }
  }
</script>
</body>
</html>
